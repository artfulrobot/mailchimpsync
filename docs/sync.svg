<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: A Pages: 1 -->
<svg width="1558pt" height="967pt"
 viewBox="0.00 0.00 1557.50 967.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 963)">
<title>A</title>
<polygon fill="#eeeeee" stroke="transparent" points="-4,4 -4,-963 1553.5,-963 1553.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="#ffee88" stroke="#444444" d="M269,-959C269,-959 207,-959 207,-959 201,-959 195,-953 195,-947 195,-947 195,-935 195,-935 195,-929 201,-923 207,-923 207,-923 269,-923 269,-923 275,-923 281,-929 281,-935 281,-935 281,-947 281,-947 281,-953 275,-959 269,-959"/>
<text text-anchor="middle" x="238" y="-937.3" font-family="Lato" font-size="14.00" fill="#000000">Start Fetch</text>
</g>
<!-- lockCheck -->
<g id="node2" class="node">
<title>lockCheck</title>
<polygon fill="#ffffff" stroke="#444444" points="381.5,-887 94.5,-887 94.5,-851 381.5,-851 381.5,-887"/>
<text text-anchor="middle" x="238" y="-865.3" font-family="Lato" font-size="14.00" fill="#000000">Check audience not locked and obtain lock</text>
</g>
<!-- start&#45;&gt;lockCheck -->
<g id="edge1" class="edge">
<title>start&#45;&gt;lockCheck</title>
<path fill="none" stroke="#000000" d="M238,-922.8314C238,-915.131 238,-905.9743 238,-897.4166"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-897.4132 238,-887.4133 234.5001,-897.4133 241.5001,-897.4132"/>
</g>
<!-- processFetchMailchimp -->
<g id="node3" class="node">
<title>processFetchMailchimp</title>
<polygon fill="#ffffff" stroke="#444444" points="436,-788.5 40,-788.5 40,-735.5 436,-735.5 436,-788.5"/>
<text text-anchor="middle" x="238" y="-773.3" font-family="Lato" font-size="14.00" fill="#000000">Fetch Mailchimp data for list</text>
<text text-anchor="middle" x="238" y="-758.3" font-family="Lato" font-size="14.00" fill="#000000">Update existing/create new cache rows based on email hash</text>
<text text-anchor="middle" x="238" y="-743.3" font-family="Lato" font-size="14.00" fill="#000000">Set sync_status: todo</text>
</g>
<!-- lockCheck&#45;&gt;processFetchMailchimp -->
<g id="edge2" class="edge">
<title>lockCheck&#45;&gt;processFetchMailchimp</title>
<path fill="none" stroke="#000000" d="M238,-850.8489C238,-836.7273 238,-816.6582 238,-799.1659"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-798.6837 238,-788.6837 234.5001,-798.6837 241.5001,-798.6837"/>
</g>
<!-- process2 -->
<g id="node4" class="node">
<title>process2</title>
<polygon fill="#ffffff" stroke="#444444" points="461,-673 15,-673 15,-620 461,-620 461,-673"/>
<text text-anchor="middle" x="238" y="-657.8" font-family="Lato" font-size="14.00" fill="#000000">check pre&#45;existing contact_ids</text>
<text text-anchor="middle" x="238" y="-642.8" font-family="Lato" font-size="14.00" fill="#000000">set them NULL if they belong to deleted contacts or no longer exist.</text>
<text text-anchor="middle" x="238" y="-627.8" font-family="Lato" font-size="14.00" fill="#000000">Set sync_status: todo</text>
</g>
<!-- processFetchMailchimp&#45;&gt;process2 -->
<g id="edge3" class="edge">
<title>processFetchMailchimp&#45;&gt;process2</title>
<path fill="none" stroke="#000000" d="M238,-735.2117C238,-719.7594 238,-700.1084 238,-683.2309"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-683.143 238,-673.1431 234.5001,-683.1431 241.5001,-683.143"/>
</g>
<!-- process3 -->
<g id="node5" class="node">
<title>process3</title>
<polygon fill="#ffffff" stroke="#444444" points="476,-572.5 0,-572.5 0,-489.5 476,-489.5 476,-572.5"/>
<text text-anchor="middle" x="238" y="-557.3" font-family="Lato" font-size="14.00" fill="#000000">populate missing contactID by email matching first of:</text>
<text text-anchor="middle" x="238" y="-542.3" font-family="Lato" font-size="14.00" fill="#000000">1. email owned by one unique not&#45;deleted contact</text>
<text text-anchor="middle" x="238" y="-527.3" font-family="Lato" font-size="14.00" fill="#000000">2. lowest contact ID of not&#45;deleted contact in the group</text>
<text text-anchor="middle" x="238" y="-512.3" font-family="Lato" font-size="14.00" fill="#000000">3. lowest contact ID of not&#45;deleted contact previously in group</text>
<text text-anchor="middle" x="238" y="-497.3" font-family="Lato" font-size="14.00" fill="#000000">4. lowest contact ID of not&#45;deleted contact who has never been in group</text>
</g>
<!-- process2&#45;&gt;process3 -->
<g id="edge4" class="edge">
<title>process2&#45;&gt;process3</title>
<path fill="none" stroke="#000000" d="M238,-619.7117C238,-608.6692 238,-595.4824 238,-582.6959"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-582.5757 238,-572.5758 234.5001,-582.5758 241.5001,-582.5757"/>
</g>
<!-- process4 -->
<g id="node6" class="node">
<title>process4</title>
<polygon fill="#ffffff" stroke="#444444" points="453.5,-422 22.5,-422 22.5,-386 453.5,-386 453.5,-422"/>
<text text-anchor="middle" x="238" y="-400.3" font-family="Lato" font-size="14.00" fill="#000000">create new CiviCRM contacts for any remaining mailchimp emails</text>
</g>
<!-- process3&#45;&gt;process4 -->
<g id="edge5" class="edge">
<title>process3&#45;&gt;process4</title>
<path fill="none" stroke="#000000" d="M238,-489.4155C238,-470.782 238,-449.2789 238,-432.5095"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-432.2509 238,-422.2509 234.5001,-432.2509 241.5001,-432.2509"/>
</g>
<!-- process5 -->
<g id="node7" class="node">
<title>process5</title>
<polygon fill="#ffffff" stroke="#444444" points="435,-330 41,-330 41,-292 435,-292 435,-330"/>
<text text-anchor="middle" x="238" y="-314.8" font-family="Lato" font-size="14.00" fill="#000000">Add in subscribers at CiviCRM not found in Mailchimp data</text>
<text text-anchor="middle" x="238" y="-299.8" font-family="Lato" font-size="14.00" fill="#000000">Set sync_status:todo</text>
</g>
<!-- process4&#45;&gt;process5 -->
<g id="edge6" class="edge">
<title>process4&#45;&gt;process5</title>
<path fill="none" stroke="#000000" d="M238,-385.6262C238,-372.762 238,-355.2975 238,-340.4978"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-340.2961 238,-330.2961 234.5001,-340.2962 241.5001,-340.2961"/>
</g>
<!-- process6 -->
<g id="node8" class="node">
<title>process6</title>
<polygon fill="#ffffff" stroke="#444444" points="416.5,-255 59.5,-255 59.5,-219 416.5,-219 416.5,-255"/>
<text text-anchor="middle" x="238" y="-233.3" font-family="Lato" font-size="14.00" fill="#000000">Now we have all *contacts* that need to be processed</text>
</g>
<!-- process5&#45;&gt;process6 -->
<g id="edge7" class="edge">
<title>process5&#45;&gt;process6</title>
<path fill="none" stroke="#000000" d="M238,-291.9432C238,-283.8174 238,-274.1682 238,-265.2408"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-265.2268 238,-255.2269 234.5001,-265.2269 241.5001,-265.2268"/>
</g>
<!-- process6b -->
<g id="node9" class="node">
<title>process6b</title>
<polygon fill="#ffffff" stroke="#444444" points="457.5,-182 18.5,-182 18.5,-146 457.5,-146 457.5,-182"/>
<text text-anchor="middle" x="238" y="-160.3" font-family="Lato" font-size="14.00" fill="#000000">Copy CiviCRM group subscription status and update date to cache</text>
</g>
<!-- process6&#45;&gt;process6b -->
<g id="edge8" class="edge">
<title>process6&#45;&gt;process6b</title>
<path fill="none" stroke="#000000" d="M238,-218.9551C238,-210.8828 238,-201.1764 238,-192.1817"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-192.0903 238,-182.0904 234.5001,-192.0904 241.5001,-192.0903"/>
</g>
<!-- process7 -->
<g id="node10" class="node">
<title>process7</title>
<polygon fill="#ffffff" stroke="#444444" points="314.5,-109 161.5,-109 161.5,-73 314.5,-73 314.5,-109"/>
<text text-anchor="middle" x="238" y="-87.3" font-family="Lato" font-size="14.00" fill="#000000">Release audience lock</text>
</g>
<!-- process6b&#45;&gt;process7 -->
<g id="edge9" class="edge">
<title>process6b&#45;&gt;process7</title>
<path fill="none" stroke="#000000" d="M238,-145.9551C238,-137.8828 238,-128.1764 238,-119.1817"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-119.0903 238,-109.0904 234.5001,-119.0904 241.5001,-119.0903"/>
</g>
<!-- end1 -->
<g id="node11" class="node">
<title>end1</title>
<path fill="#ffee88" stroke="#444444" d="M265,-36C265,-36 211,-36 211,-36 205,-36 199,-30 199,-24 199,-24 199,-12 199,-12 199,-6 205,0 211,0 211,0 265,0 265,0 271,0 277,-6 277,-12 277,-12 277,-24 277,-24 277,-30 271,-36 265,-36"/>
<text text-anchor="middle" x="238" y="-14.3" font-family="Lato" font-size="14.00" fill="#000000">End fetch</text>
</g>
<!-- process7&#45;&gt;end1 -->
<g id="edge10" class="edge">
<title>process7&#45;&gt;end1</title>
<path fill="none" stroke="#000000" d="M238,-72.9551C238,-64.8828 238,-55.1764 238,-46.1817"/>
<polygon fill="#000000" stroke="#000000" points="241.5001,-46.0903 238,-36.0904 234.5001,-46.0904 241.5001,-46.0903"/>
</g>
<!-- start2 -->
<g id="node12" class="node">
<title>start2</title>
<path fill="#ffee88" stroke="#444444" d="M653.5,-959C653.5,-959 538.5,-959 538.5,-959 532.5,-959 526.5,-953 526.5,-947 526.5,-947 526.5,-935 526.5,-935 526.5,-929 532.5,-923 538.5,-923 538.5,-923 653.5,-923 653.5,-923 659.5,-923 665.5,-929 665.5,-935 665.5,-935 665.5,-947 665.5,-947 665.5,-953 659.5,-959 653.5,-959"/>
<text text-anchor="middle" x="596" y="-937.3" font-family="Lato" font-size="14.00" fill="#000000">Start Reconciliation</text>
</g>
<!-- p8 -->
<g id="node13" class="node">
<title>p8</title>
<polygon fill="#ffffff" stroke="#444444" points="702,-887 490,-887 490,-851 702,-851 702,-887"/>
<text text-anchor="middle" x="596" y="-865.3" font-family="Lato" font-size="14.00" fill="#000000">Process each &#39;todo&#39; row in turn</text>
</g>
<!-- start2&#45;&gt;p8 -->
<g id="edge11" class="edge">
<title>start2&#45;&gt;p8</title>
<path fill="none" stroke="#000000" d="M596,-922.8314C596,-915.131 596,-905.9743 596,-897.4166"/>
<polygon fill="#000000" stroke="#000000" points="599.5001,-897.4132 596,-887.4133 592.5001,-897.4133 599.5001,-897.4132"/>
</g>
<!-- onlyCiviUpdates -->
<g id="node14" class="node">
<title>onlyCiviUpdates</title>
<polygon fill="#ffffff" stroke="#444444" points="596,-815 522,-762 596,-709 670,-762 596,-815"/>
<text text-anchor="middle" x="596" y="-773.3" font-family="Lato" font-size="14.00" fill="#000000">CiviCRM</text>
<text text-anchor="middle" x="596" y="-758.3" font-family="Lato" font-size="14.00" fill="#000000">updates</text>
<text text-anchor="middle" x="596" y="-743.3" font-family="Lato" font-size="14.00" fill="#000000">needed?</text>
</g>
<!-- p8&#45;&gt;onlyCiviUpdates -->
<g id="edge12" class="edge">
<title>p8&#45;&gt;onlyCiviUpdates</title>
<path fill="none" stroke="#000000" d="M596,-850.8489C596,-843.5803 596,-834.7361 596,-825.4787"/>
<polygon fill="#000000" stroke="#000000" points="599.5001,-825.3261 596,-815.3261 592.5001,-825.3262 599.5001,-825.3261"/>
</g>
<!-- p9 -->
<g id="node15" class="node">
<title>p9</title>
<polygon fill="#ffffff" stroke="#444444" points="649,-665.5 483,-665.5 483,-627.5 649,-627.5 649,-665.5"/>
<text text-anchor="middle" x="566" y="-650.3" font-family="Lato" font-size="14.00" fill="#000000">Make CiviCRM updates</text>
<text text-anchor="middle" x="566" y="-635.3" font-family="Lato" font-size="14.00" fill="#000000">Set sync_status:ok</text>
</g>
<!-- onlyCiviUpdates&#45;&gt;p9 -->
<g id="edge13" class="edge">
<title>onlyCiviUpdates&#45;&gt;p9</title>
<path fill="none" stroke="#000000" d="M584.3153,-717.014C580.6907,-703.0592 576.7942,-688.0577 573.531,-675.4942"/>
<polygon fill="#000000" stroke="#000000" points="576.8603,-674.3896 570.9586,-665.5907 570.0851,-676.1494 576.8603,-674.3896"/>
<text text-anchor="middle" x="571.5775" y="-697.8949" font-family="Lato" font-size="14.00" fill="#000000">Yes</text>
</g>
<!-- mailchimpupdates1 -->
<g id="node16" class="node">
<title>mailchimpupdates1</title>
<polygon fill="#ffffff" stroke="#444444" points="636,-584 553,-531 636,-478 719,-531 636,-584"/>
<text text-anchor="middle" x="636" y="-542.3" font-family="Lato" font-size="14.00" fill="#000000">Mailchimp</text>
<text text-anchor="middle" x="636" y="-527.3" font-family="Lato" font-size="14.00" fill="#000000">updates</text>
<text text-anchor="middle" x="636" y="-512.3" font-family="Lato" font-size="14.00" fill="#000000">needed?</text>
</g>
<!-- onlyCiviUpdates&#45;&gt;mailchimpupdates1 -->
<g id="edge16" class="edge">
<title>onlyCiviUpdates&#45;&gt;mailchimpupdates1</title>
<path fill="none" stroke="#000000" d="M625.4756,-729.9593C638.113,-714.0684 651.4565,-693.8408 658,-673 667.085,-644.0647 662.5801,-610.5881 655.3436,-583.4088"/>
<polygon fill="#000000" stroke="#000000" points="658.6832,-582.3565 652.5741,-573.7003 651.9517,-584.2768 658.6832,-582.3565"/>
<text text-anchor="middle" x="629.9289" y="-706.7614" font-family="Lato" font-size="14.00" fill="#000000">No</text>
</g>
<!-- p9&#45;&gt;mailchimpupdates1 -->
<g id="edge14" class="edge">
<title>p9&#45;&gt;mailchimpupdates1</title>
<path fill="none" stroke="#000000" d="M577.5591,-627.4275C585.6938,-614.0053 596.955,-595.4242 607.4226,-578.1526"/>
<polygon fill="#000000" stroke="#000000" points="610.6136,-579.6404 612.8034,-569.2743 604.6272,-576.0123 610.6136,-579.6404"/>
</g>
<!-- p10 -->
<g id="node17" class="node">
<title>p10</title>
<polygon fill="#ffffff" stroke="#444444" points="637.5,-423 494.5,-423 494.5,-385 637.5,-385 637.5,-423"/>
<text text-anchor="middle" x="566" y="-407.8" font-family="Lato" font-size="14.00" fill="#000000">Store update</text>
<text text-anchor="middle" x="566" y="-392.8" font-family="Lato" font-size="14.00" fill="#000000">Set sync_status: live</text>
</g>
<!-- mailchimpupdates1&#45;&gt;p10 -->
<g id="edge15" class="edge">
<title>mailchimpupdates1&#45;&gt;p10</title>
<path fill="none" stroke="#000000" d="M614.2353,-491.5126C603.67,-472.3441 591.2177,-449.7521 581.6119,-432.3244"/>
<polygon fill="#000000" stroke="#000000" points="584.4906,-430.2965 576.5982,-423.2282 578.3602,-433.6755 584.4906,-430.2965"/>
<text text-anchor="middle" x="598.0831" y="-476.0181" font-family="Lato" font-size="14.00" fill="#000000">Yes</text>
</g>
<!-- loop1 -->
<g id="node18" class="node">
<title>loop1</title>
<polygon fill="#ffffff" stroke="#444444" points="704.5,-330 471.5,-330 471.5,-292 704.5,-292 704.5,-330"/>
<text text-anchor="middle" x="588" y="-314.8" font-family="Lato" font-size="14.00" fill="#000000">Repeat next row,</text>
<text text-anchor="middle" x="588" y="-299.8" font-family="Lato" font-size="14.00" fill="#000000">or stop and do another batch later</text>
</g>
<!-- mailchimpupdates1&#45;&gt;loop1 -->
<g id="edge18" class="edge">
<title>mailchimpupdates1&#45;&gt;loop1</title>
<path fill="none" stroke="#000000" d="M649.2783,-486.4013C657.0426,-452.0876 662.4333,-404.2304 646,-366 641.2528,-354.9562 633.0773,-345.0888 624.3372,-336.8663"/>
<polygon fill="#000000" stroke="#000000" points="626.412,-334.0308 616.5831,-330.0756 621.8002,-339.2969 626.412,-334.0308"/>
<text text-anchor="middle" x="644.7253" y="-463.2264" font-family="Lato" font-size="14.00" fill="#000000">No</text>
</g>
<!-- p10&#45;&gt;loop1 -->
<g id="edge17" class="edge">
<title>p10&#45;&gt;loop1</title>
<path fill="none" stroke="#000000" d="M570.5584,-384.7303C573.5967,-371.8866 577.6473,-354.7635 581.0802,-340.2518"/>
<polygon fill="#000000" stroke="#000000" points="584.5513,-340.7821 583.4474,-330.245 577.7393,-339.1707 584.5513,-340.7821"/>
</g>
<!-- loop1&#45;&gt;p8 -->
<g id="edge19" class="edge">
<title>loop1:e&#45;&gt;p8:e</title>
<path fill="none" stroke="#000000" d="M704,-311C778.9848,-311 722.6531,-403.2061 728,-478 730.8804,-518.2911 743.5132,-820.3535 710.5573,-863.8006"/>
<polygon fill="#000000" stroke="#000000" points="708.7287,-860.8161 702,-869 712.3636,-866.7984 708.7287,-860.8161"/>
</g>
<!-- end2 -->
<g id="node19" class="node">
<title>end2</title>
<path fill="#ffee88" stroke="#444444" d="M643,-36C643,-36 533,-36 533,-36 527,-36 521,-30 521,-24 521,-24 521,-12 521,-12 521,-6 527,0 533,0 533,0 643,0 643,0 649,0 655,-6 655,-12 655,-12 655,-24 655,-24 655,-30 649,-36 643,-36"/>
<text text-anchor="middle" x="588" y="-14.3" font-family="Lato" font-size="14.00" fill="#000000">End Reconciliation</text>
</g>
<!-- loop1&#45;&gt;end2 -->
<g id="edge20" class="edge">
<title>loop1&#45;&gt;end2</title>
<path fill="none" stroke="#000000" d="M588,-291.7755C588,-241.4368 588,-105.5756 588,-46.3012"/>
<polygon fill="#000000" stroke="#000000" points="591.5001,-46.1625 588,-36.1625 584.5001,-46.1626 591.5001,-46.1625"/>
</g>
<!-- start3 -->
<g id="node20" class="node">
<title>start3</title>
<path fill="#ffee88" stroke="#444444" d="M902,-959C902,-959 786,-959 786,-959 780,-959 774,-953 774,-947 774,-947 774,-935 774,-935 774,-929 780,-923 786,-923 786,-923 902,-923 902,-923 908,-923 914,-929 914,-935 914,-935 914,-947 914,-947 914,-953 908,-959 902,-959"/>
<text text-anchor="middle" x="844" y="-937.3" font-family="Lato" font-size="14.00" fill="#000000">Start Batch updates</text>
</g>
<!-- p11 -->
<g id="node21" class="node">
<title>p11</title>
<polygon fill="#ffffff" stroke="#444444" points="960.5,-887 727.5,-887 727.5,-851 960.5,-851 960.5,-887"/>
<text text-anchor="middle" x="844" y="-865.3" font-family="Lato" font-size="14.00" fill="#000000">Take up to 1,000 items from batch</text>
</g>
<!-- start3&#45;&gt;p11 -->
<g id="edge21" class="edge">
<title>start3&#45;&gt;p11</title>
<path fill="none" stroke="#000000" d="M844,-922.8314C844,-915.131 844,-905.9743 844,-897.4166"/>
<polygon fill="#000000" stroke="#000000" points="847.5001,-897.4132 844,-887.4133 840.5001,-897.4133 847.5001,-897.4132"/>
</g>
<!-- p12 -->
<g id="node22" class="node">
<title>p12</title>
<polygon fill="#ffffff" stroke="#444444" points="984.5,-256 703.5,-256 703.5,-218 984.5,-218 984.5,-256"/>
<text text-anchor="middle" x="844" y="-240.8" font-family="Lato" font-size="14.00" fill="#000000">Submit batch, create row in batches table,</text>
<text text-anchor="middle" x="844" y="-225.8" font-family="Lato" font-size="14.00" fill="#000000">store ID in updates table rows</text>
</g>
<!-- p11&#45;&gt;p12 -->
<g id="edge22" class="edge">
<title>p11&#45;&gt;p12</title>
<path fill="none" stroke="#000000" d="M844,-850.83C844,-812.8756 844,-722.4049 844,-646.5 844,-646.5 844,-646.5 844,-404 844,-355.8104 844,-299.7988 844,-266.4362"/>
<polygon fill="#000000" stroke="#000000" points="847.5001,-266.0342 844,-256.0342 840.5001,-266.0342 847.5001,-266.0342"/>
</g>
<!-- loop2 -->
<g id="node23" class="node">
<title>loop2</title>
<polygon fill="#ffffff" stroke="#444444" points="960.5,-110 727.5,-110 727.5,-72 960.5,-72 960.5,-110"/>
<text text-anchor="middle" x="844" y="-94.8" font-family="Lato" font-size="14.00" fill="#000000">Repeat next batch,</text>
<text text-anchor="middle" x="844" y="-79.8" font-family="Lato" font-size="14.00" fill="#000000">or stop and do another batch later</text>
</g>
<!-- p12&#45;&gt;loop2 -->
<g id="edge23" class="edge">
<title>p12&#45;&gt;loop2</title>
<path fill="none" stroke="#000000" d="M844,-217.913C844,-193.102 844,-149.5176 844,-120.4513"/>
<polygon fill="#000000" stroke="#000000" points="847.5001,-120.0916 844,-110.0916 840.5001,-120.0917 847.5001,-120.0916"/>
</g>
<!-- end3 -->
<g id="node24" class="node">
<title>end3</title>
<path fill="#ffee88" stroke="#444444" d="M899.5,-36C899.5,-36 788.5,-36 788.5,-36 782.5,-36 776.5,-30 776.5,-24 776.5,-24 776.5,-12 776.5,-12 776.5,-6 782.5,0 788.5,0 788.5,0 899.5,0 899.5,0 905.5,0 911.5,-6 911.5,-12 911.5,-12 911.5,-24 911.5,-24 911.5,-30 905.5,-36 899.5,-36"/>
<text text-anchor="middle" x="844" y="-14.3" font-family="Lato" font-size="14.00" fill="#000000">End Batch updates</text>
</g>
<!-- loop2&#45;&gt;end3 -->
<g id="edge24" class="edge">
<title>loop2&#45;&gt;end3</title>
<path fill="none" stroke="#000000" d="M844,-71.8201C844,-64.0975 844,-55.0282 844,-46.5585"/>
<polygon fill="#000000" stroke="#000000" points="847.5001,-46.2973 844,-36.2973 840.5001,-46.2974 847.5001,-46.2973"/>
</g>
<!-- start4 -->
<g id="node25" class="node">
<title>start4</title>
<path fill="#ffee88" stroke="#444444" d="M1206.5,-959C1206.5,-959 1101.5,-959 1101.5,-959 1095.5,-959 1089.5,-953 1089.5,-947 1089.5,-947 1089.5,-935 1089.5,-935 1089.5,-929 1095.5,-923 1101.5,-923 1101.5,-923 1206.5,-923 1206.5,-923 1212.5,-923 1218.5,-929 1218.5,-935 1218.5,-935 1218.5,-947 1218.5,-947 1218.5,-953 1212.5,-959 1206.5,-959"/>
<text text-anchor="middle" x="1154" y="-937.3" font-family="Lato" font-size="14.00" fill="#000000">Batches webhook</text>
</g>
<!-- bwh1 -->
<g id="node26" class="node">
<title>bwh1</title>
<polygon fill="#ffffff" stroke="#444444" points="1222.5,-887 1085.5,-887 1085.5,-851 1222.5,-851 1222.5,-887"/>
<text text-anchor="middle" x="1154" y="-865.3" font-family="Lato" font-size="14.00" fill="#000000">Uncompress; untar</text>
</g>
<!-- start4&#45;&gt;bwh1 -->
<g id="edge25" class="edge">
<title>start4&#45;&gt;bwh1</title>
<path fill="none" stroke="#000000" d="M1154,-922.8314C1154,-915.131 1154,-905.9743 1154,-897.4166"/>
<polygon fill="#000000" stroke="#000000" points="1157.5001,-897.4132 1154,-887.4133 1150.5001,-897.4133 1157.5001,-897.4132"/>
</g>
<!-- bwh2 -->
<g id="node27" class="node">
<title>bwh2</title>
<polygon fill="#ffffff" stroke="#444444" points="1213,-780 1095,-780 1095,-744 1213,-744 1213,-780"/>
<text text-anchor="middle" x="1154" y="-758.3" font-family="Lato" font-size="14.00" fill="#000000">Loop responses.</text>
</g>
<!-- bwh1&#45;&gt;bwh2 -->
<g id="edge26" class="edge">
<title>bwh1&#45;&gt;bwh2</title>
<path fill="none" stroke="#000000" d="M1154,-850.8489C1154,-834.3242 1154,-809.6555 1154,-790.5016"/>
<polygon fill="#000000" stroke="#000000" points="1157.5001,-790.2401 1154,-780.2401 1150.5001,-790.2402 1157.5001,-790.2401"/>
</g>
<!-- bwh3 -->
<g id="node28" class="node">
<title>bwh3</title>
<polygon fill="#ffffff" stroke="#444444" points="1172,-664.5 1105.6409,-646.5 1172,-628.5 1238.3591,-646.5 1172,-664.5"/>
<text text-anchor="middle" x="1172" y="-642.8" font-family="Lato" font-size="14.00" fill="#000000">Success?</text>
</g>
<!-- bwh2&#45;&gt;bwh3 -->
<g id="edge27" class="edge">
<title>bwh2&#45;&gt;bwh3</title>
<path fill="none" stroke="#000000" d="M1156.8125,-743.9531C1159.7355,-725.1969 1164.3463,-695.6109 1167.7214,-673.9543"/>
<polygon fill="#000000" stroke="#000000" points="1171.1845,-674.4617 1169.2662,-664.042 1164.268,-673.3837 1171.1845,-674.4617"/>
</g>
<!-- bwh4 -->
<g id="node29" class="node">
<title>bwh4</title>
<polygon fill="#ffffff" stroke="#444444" points="1050,-422 872,-422 872,-386 1050,-386 1050,-422"/>
<text text-anchor="middle" x="961" y="-400.3" font-family="Lato" font-size="14.00" fill="#000000">Set cache table status &#39;ok&#39;</text>
</g>
<!-- bwh3&#45;&gt;bwh4 -->
<g id="edge28" class="edge">
<title>bwh3:w&#45;&gt;bwh4</title>
<path fill="none" stroke="#000000" d="M1106,-646.5C1007.2314,-646.5 974.1305,-496.4825 964.4992,-432.4339"/>
<polygon fill="#000000" stroke="#000000" points="967.9215,-431.638 963.0551,-422.2269 960.9905,-432.6186 967.9215,-431.638"/>
<text text-anchor="middle" x="1086.7989" y="-648.3961" font-family="Lato" font-size="14.00" fill="#000000">Yes</text>
</g>
<!-- bwh5a -->
<g id="node31" class="node">
<title>bwh5a</title>
<polygon fill="#ffffff" stroke="#444444" points="1345.5,-549 1130.5,-549 1130.5,-513 1345.5,-513 1345.5,-549"/>
<text text-anchor="middle" x="1238" y="-527.3" font-family="Lato" font-size="14.00" fill="#000000">Store response in updates table</text>
</g>
<!-- bwh3&#45;&gt;bwh5a -->
<g id="edge30" class="edge">
<title>bwh3:e&#45;&gt;bwh5a</title>
<path fill="none" stroke="#000000" d="M1238,-646.5C1273.041,-646.5 1260.2428,-592.6809 1248.5892,-558.5184"/>
<polygon fill="#000000" stroke="#000000" points="1251.8689,-557.2947 1245.2188,-549.0469 1245.274,-559.6416 1251.8689,-557.2947"/>
<text text-anchor="middle" x="1254.4657" y="-631.4475" font-family="Lato" font-size="14.00" fill="#000000">No</text>
</g>
<!-- bwh9 -->
<g id="node30" class="node">
<title>bwh9</title>
<polygon fill="#ffffff" stroke="#444444" points="1240,-182 1124,-182 1124,-146 1240,-146 1240,-182"/>
<text text-anchor="middle" x="1182" y="-160.3" font-family="Lato" font-size="14.00" fill="#000000">Loop until done</text>
</g>
<!-- bwh4&#45;&gt;bwh9 -->
<g id="edge29" class="edge">
<title>bwh4&#45;&gt;bwh9:n</title>
<path fill="none" stroke="#000000" d="M965.97,-385.9241C977.1105,-348.8029 1007.6276,-263.6414 1064,-218 1106.6145,-183.4975 1182,-236.8308 1182,-182"/>
</g>
<!-- bwh9&#45;&gt;bwh2 -->
<g id="edge38" class="edge">
<title>bwh9:w&#45;&gt;bwh2:w</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1124,-164C1055.5426,-164 1078,-242.5426 1078,-311 1078,-531 1078,-531 1078,-531 1078,-630.3252 997.9924,-753.0271 1084.831,-761.5318"/>
<polygon fill="#000000" stroke="#000000" points="1084.8496,-765.0363 1095,-762 1085.1716,-758.0437 1084.8496,-765.0363"/>
</g>
<!-- end4b -->
<g id="node36" class="node">
<title>end4b</title>
<path fill="#ffee88" stroke="#444444" d="M1248.5,-36C1248.5,-36 1115.5,-36 1115.5,-36 1109.5,-36 1103.5,-30 1103.5,-24 1103.5,-24 1103.5,-12 1103.5,-12 1103.5,-6 1109.5,0 1115.5,0 1115.5,0 1248.5,0 1248.5,0 1254.5,0 1260.5,-6 1260.5,-12 1260.5,-12 1260.5,-24 1260.5,-24 1260.5,-30 1254.5,-36 1248.5,-36"/>
<text text-anchor="middle" x="1182" y="-14.3" font-family="Lato" font-size="14.00" fill="#000000">Batches webhook end</text>
</g>
<!-- bwh9&#45;&gt;end4b -->
<g id="edge37" class="edge">
<title>bwh9:s&#45;&gt;end4b:n</title>
<path fill="none" stroke="#000000" d="M1182,-146C1182,-100.6441 1182,-86.8469 1182,-46.0522"/>
<polygon fill="#000000" stroke="#000000" points="1185.5001,-46 1182,-36 1178.5001,-46 1185.5001,-46"/>
</g>
<!-- bwh5b -->
<g id="node32" class="node">
<title>bwh5b</title>
<polygon fill="#ffffff" stroke="#444444" points="1238,-442 1138,-404 1238,-366 1338,-404 1238,-442"/>
<text text-anchor="middle" x="1238" y="-407.8" font-family="Lato" font-size="14.00" fill="#000000">Manual</text>
<text text-anchor="middle" x="1238" y="-392.8" font-family="Lato" font-size="14.00" fill="#000000">unsubscribe?</text>
</g>
<!-- bwh5a&#45;&gt;bwh5b -->
<g id="edge31" class="edge">
<title>bwh5a&#45;&gt;bwh5b</title>
<path fill="none" stroke="#000000" d="M1238,-512.804C1238,-497.0075 1238,-473.4064 1238,-452.2185"/>
<polygon fill="#000000" stroke="#000000" points="1241.5001,-452.0558 1238,-442.0558 1234.5001,-452.0558 1241.5001,-452.0558"/>
</g>
<!-- bwh6 -->
<g id="node33" class="node">
<title>bwh6</title>
<polygon fill="#ffffff" stroke="#444444" points="1337.5,-329 1128.5,-329 1128.5,-293 1337.5,-293 1337.5,-329"/>
<text text-anchor="middle" x="1233" y="-307.3" font-family="Lato" font-size="14.00" fill="#000000">Set cache table status &#39;redo&#39; ??</text>
</g>
<!-- bwh5b&#45;&gt;bwh6 -->
<g id="edge32" class="edge">
<title>bwh5b&#45;&gt;bwh6</title>
<path fill="none" stroke="#000000" d="M1235.9951,-366.7092C1235.5061,-357.6131 1234.9907,-348.0273 1234.528,-339.4203"/>
<polygon fill="#000000" stroke="#000000" points="1238.0078,-338.9498 1233.9759,-329.1521 1231.0179,-339.3256 1238.0078,-338.9498"/>
<text text-anchor="middle" x="1226.5818" y="-345.363" font-family="Lato" font-size="14.00" fill="#000000">Yes</text>
</g>
<!-- bwh8 -->
<g id="node35" class="node">
<title>bwh8</title>
<polygon fill="#ffffff" stroke="#444444" points="1549.5,-255 1368.5,-255 1368.5,-219 1549.5,-219 1549.5,-255"/>
<text text-anchor="middle" x="1459" y="-233.3" font-family="Lato" font-size="14.00" fill="#000000">Set cache table status &#39;fail&#39;</text>
</g>
<!-- bwh5b&#45;&gt;bwh8 -->
<g id="edge35" class="edge">
<title>bwh5b&#45;&gt;bwh8</title>
<path fill="none" stroke="#000000" d="M1275.2007,-380.0302C1296.5624,-365.9497 1323.691,-347.5255 1347,-330 1376.3261,-307.9504 1408.4085,-281.0018 1430.6905,-261.8011"/>
<polygon fill="#000000" stroke="#000000" points="1433.1614,-264.2914 1438.433,-255.1011 1428.5809,-258.9981 1433.1614,-264.2914"/>
<text text-anchor="middle" x="1285.6519" y="-359.2781" font-family="Lato" font-size="14.00" fill="#000000">No</text>
</g>
<!-- bwh7 -->
<g id="node34" class="node">
<title>bwh7</title>
<polygon fill="#ffffff" stroke="#444444" points="1350,-255 1106,-255 1106,-219 1350,-219 1350,-255"/>
<text text-anchor="middle" x="1228" y="-233.3" font-family="Lato" font-size="14.00" fill="#000000">Add alternate update to batch table.</text>
</g>
<!-- bwh6&#45;&gt;bwh7 -->
<g id="edge33" class="edge">
<title>bwh6&#45;&gt;bwh7</title>
<path fill="none" stroke="#000000" d="M1231.764,-292.7079C1231.2009,-284.3739 1230.5217,-274.3216 1229.8962,-265.0633"/>
<polygon fill="#000000" stroke="#000000" points="1233.388,-264.823 1229.2217,-255.0817 1226.4039,-265.295 1233.388,-264.823"/>
</g>
<!-- bwh7&#45;&gt;bwh9 -->
<g id="edge34" class="edge">
<title>bwh7&#45;&gt;bwh9:n</title>
<path fill="none" stroke="#000000" d="M1202.0425,-218.8451C1191.6084,-209.3041 1182,-196.5642 1182,-182"/>
</g>
<!-- bwh8&#45;&gt;bwh9 -->
<g id="edge36" class="edge">
<title>bwh8&#45;&gt;bwh9:n</title>
<path fill="none" stroke="#000000" d="M1368.2998,-219.5231C1287.515,-203.8773 1182,-183.2104 1182,-182"/>
</g>
</g>
</svg>
